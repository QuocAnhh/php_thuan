<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Trang Quản Trị - HUMG (Demo)</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700;800;900&display=swap"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />

    <link href="./assets/admin/admin.css" rel="stylesheet" />
  </head>
  <body>
    <header class="header">
      <div class="header-content">
        <div class="logo">
          <img
            src="./assets/trangchu/img/logo-removebg-preview.png"
            alt="HUMG Logo"
          />
          <h1>Trang Quản Trị (Demo)</h1>
        </div>
        <div class="user-info">
          <div class="user-avatar" id="userAvatar">
            <i class="fas fa-user"></i>
          </div>
          <div>
            <div id="userName">Admin Demo</div>
            <button class="logout-btn" onclick="dangXuat()">
              <i class="fas fa-sign-out-alt"></i> Đăng xuất
            </button>
          </div>
        </div>
      </div>
    </header>

    <div class="container">
      <div class="main-content">
        <aside class="sidebar">
          <h3>Menu Quản Trị</h3>
          <ul class="menu-list">
            <li class="menu-item">
              <a
                href="#"
                class="menu-link active"
                onclick="hienThiTrang('tongQuan')"
              >
                <i class="fas fa-tachometer-alt"></i>
                Tổng quan
              </a>
            </li>
            <li class="menu-item">
              <a href="#" class="menu-link" onclick="hienThiTrang('hoSo')">
                <i class="fas fa-file-alt"></i>
                Quản lý hồ sơ
              </a>
            </li>
            <li class="menu-item">
              <a href="#" class="menu-link" onclick="hienThiTrang('nguoiDung')">
                <i class="fas fa-users"></i>
                Quản lý người dùng
              </a>
            </li>
            <li class="menu-item">
              <a href="#" class="menu-link" onclick="hienThiTrang('thongBao')">
                <i class="fas fa-bell"></i>
                Thông báo
              </a>
            </li>
            <li class="menu-item">
              <a href="#" class="menu-link" onclick="hienThiTrang('caiDat')">
                <i class="fas fa-cog"></i>
                Cài đặt
              </a>
            </li>
          </ul>
        </aside>

        <main class="dashboard-content">
          <div id="tongQuan" class="page-content">
            <h2 class="page-title">
              <i class="fas fa-tachometer-alt"></i>
              Tổng quan hệ thống
            </h2>

            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-number" id="tongHoSo">24</div>
                <div class="stat-label">Tổng hồ sơ</div>
              </div>
              <div class="stat-card">
                <div class="stat-number" id="hoSoCho">8</div>
                <div class="stat-label">Hồ sơ chờ xử lý</div>
              </div>
              <div class="stat-card">
                <div class="stat-number" id="hoSoDuyet">12</div>
                <div class="stat-label">Hồ sơ đã duyệt</div>
              </div>
              <div class="stat-card">
                <div class="stat-number" id="hoSoTuChoi">4</div>
                <div class="stat-label">Hồ sơ từ chối</div>
              </div>
            </div>

            <div class="recent-applications">
              <h3>Hồ sơ gần đây</h3>
              <div class="table-container">
                <table class="data-table" id="recentTable">
                  <thead>
                    <tr>
                      <th>Thí sinh</th>
                      <th>Ngày nộp</th>
                      <th>Trạng thái</th>
                      <th>Thao tác</th>
                    </tr>
                  </thead>
                  <tbody id="recentTableBody"></tbody>
                </table>
              </div>
            </div>
          </div>

          <div id="hoSo" class="page-content" style="display: none">
            <h2 class="page-title">
              <i class="fas fa-file-alt"></i>
              Quản lý hồ sơ
            </h2>

            <div class="filters">
              <div class="filter-group">
                <label>Trạng thái:</label>
                <select
                  class="filter-select"
                  id="filterTrangThai"
                  onchange="locHoSo()"
                >
                  <option value="">Tất cả</option>
                  <option value="pending">Chờ xử lý</option>
                  <option value="processing">Đang xử lý</option>
                  <option value="approved">Đã duyệt</option>
                  <option value="rejected">Từ chối</option>
                </select>
              </div>
              <div class="filter-group">
                <label>Tìm kiếm:</label>
                <input
                  type="text"
                  class="filter-select"
                  id="searchInput"
                  placeholder="Tìm theo tên thí sinh..."
                  onkeyup="timKiemHoSo()"
                />
              </div>
            </div>

            <div class="table-container">
              <table class="data-table" id="applicationsTable">
                <thead>
                  <tr>
                    <th>Thí sinh</th>
                    <th>Email</th>
                    <th>Ngày nộp</th>
                    <th>Nguyện vọng</th>
                    <th>Trạng thái</th>
                    <th>Thao tác</th>
                  </tr>
                </thead>
                <tbody id="applicationsTableBody"></tbody>
              </table>
            </div>
          </div>

          <div id="nguoiDung" class="page-content" style="display: none">
            <h2 class="page-title">
              <i class="fas fa-users"></i>
              Quản lý người dùng
            </h2>
            <div class="demo-content">
              <div class="demo-card">
                <h3>Danh sách người dùng</h3>
                <p>
                  Chức năng này sẽ hiển thị danh sách tất cả người dùng trong hệ
                  thống.
                </p>
                <div class="demo-stats">
                  <div class="demo-stat">
                    <span class="demo-number">156</span>
                    <span class="demo-label">Tổng người dùng</span>
                  </div>
                  <div class="demo-stat">
                    <span class="demo-number">142</span>
                    <span class="demo-label">Thí sinh</span>
                  </div>
                  <div class="demo-stat">
                    <span class="demo-number">14</span>
                    <span class="demo-label">Admin</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div id="thongBao" class="page-content" style="display: none">
            <h2 class="page-title">
              <i class="fas fa-bell"></i>
              Quản lý thông báo
            </h2>
            <div class="demo-content">
              <div class="demo-card">
                <h3>Hệ thống thông báo</h3>
                <p>Quản lý và gửi thông báo đến thí sinh.</p>
                <div class="demo-notifications">
                  <div class="demo-notification">
                    <i class="fas fa-info-circle"></i>
                    <span>Thông báo tuyển sinh năm 2025</span>
                    <span class="demo-time">2 giờ trước</span>
                  </div>
                  <div class="demo-notification">
                    <i class="fas fa-check-circle"></i>
                    <span>Hồ sơ của Nguyễn Văn A đã được duyệt</span>
                    <span class="demo-time">1 ngày trước</span>
                  </div>
                  <div class="demo-notification">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Hồ sơ của Trần Thị B bị từ chối</span>
                    <span class="demo-time">2 ngày trước</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div id="caiDat" class="page-content" style="display: none">
            <h2 class="page-title">
              <i class="fas fa-cog"></i>
              Cài đặt hệ thống
            </h2>
            <div class="demo-content">
              <div class="demo-card">
                <h3>Cấu hình hệ thống</h3>
                <p>Các tùy chọn cài đặt cho hệ thống quản lý tuyển sinh.</p>
                <div class="demo-settings">
                  <div class="demo-setting">
                    <label>Thời gian mở đăng ký:</label>
                    <input type="date" value="2025-01-01" disabled />
                  </div>
                  <div class="demo-setting">
                    <label>Thời gian đóng đăng ký:</label>
                    <input type="date" value="2025-07-31" disabled />
                  </div>
                  <div class="demo-setting">
                    <label>Số nguyện vọng tối đa:</label>
                    <input type="number" value="5" disabled />
                  </div>
                  <div class="demo-setting">
                    <label>Kích thước file tối đa:</label>
                    <input type="text" value="10MB" disabled />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>

    <div id="modalChiTiet" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Chi tiết hồ sơ</h3>
          <span class="close" onclick="dongModal()">&times;</span>
        </div>
        <div id="modalContent"></div>
      </div>
    </div>

    <style>
      /* Demo specific styles */
      .demo-content {
        padding: 20px 0;
      }

      .demo-card {
        background: #f8fafc;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 25px;
        margin-bottom: 20px;
      }

      .demo-card h3 {
        color: #012750;
        margin-bottom: 15px;
        font-size: 18px;
      }

      .demo-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }

      .demo-stat {
        text-align: center;
        padding: 20px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .demo-number {
        display: block;
        font-size: 24px;
        font-weight: bold;
        color: #012750;
        margin-bottom: 5px;
      }

      .demo-label {
        font-size: 14px;
        color: #6b7280;
      }

      .demo-notifications {
        margin-top: 20px;
      }

      .demo-notification {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 15px;
        background: white;
        border-radius: 8px;
        margin-bottom: 10px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .demo-notification i {
        color: #012750;
        font-size: 18px;
      }

      .demo-time {
        margin-left: auto;
        font-size: 12px;
        color: #9ca3af;
      }

      .demo-settings {
        margin-top: 20px;
      }

      .demo-setting {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px 0;
        border-bottom: 1px solid #e5e7eb;
      }

      .demo-setting:last-child {
        border-bottom: none;
      }

      .demo-setting label {
        font-weight: 600;
        color: #374151;
      }

      .demo-setting input {
        padding: 8px 12px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        background: #f9fafb;
        color: #6b7280;
      }
    </style>

    <script>
      // Dữ liệu demo
      const duLieuDemo = [
        {
          id: 1,
          user: { name: "Nguyễn Văn An", email: "nguyenvanan@email.com" },
          submitted_at: "2025-01-15T10:30:00",
          status: "pending",
          aspirations: [
            { major: { name: "Công nghệ thông tin" }, priority: 1 },
            { major: { name: "Khoa học máy tính" }, priority: 2 },
          ],
          documents: [
            { document_type: "hoc_ba", original_filename: "hoc_ba_an.pdf" },
            { document_type: "cccd", original_filename: "cccd_an.jpg" },
          ],
        },
        {
          id: 2,
          user: { name: "Trần Thị Bình", email: "tranthibinh@email.com" },
          submitted_at: "2025-01-14T14:20:00",
          status: "approved",
          aspirations: [
            { major: { name: "Quản trị kinh doanh" }, priority: 1 },
          ],
          documents: [
            { document_type: "hoc_ba", original_filename: "hoc_ba_binh.pdf" },
            { document_type: "cccd", original_filename: "cccd_binh.jpg" },
            {
              document_type: "bang_tot_nghiep",
              original_filename: "bang_tot_nghiep_binh.pdf",
            },
          ],
        },
        {
          id: 3,
          user: { name: "Lê Văn Cường", email: "levancuong@email.com" },
          submitted_at: "2025-01-13T09:15:00",
          status: "rejected",
          aspirations: [
            { major: { name: "Công nghệ thông tin" }, priority: 1 },
            { major: { name: "Kỹ thuật điện" }, priority: 2 },
          ],
          documents: [
            { document_type: "hoc_ba", original_filename: "hoc_ba_cuong.pdf" },
          ],
        },
        {
          id: 4,
          user: { name: "Phạm Thị Dung", email: "phamthidung@email.com" },
          submitted_at: "2025-01-12T16:45:00",
          status: "processing",
          aspirations: [
            { major: { name: "Công nghệ thông tin" }, priority: 1 },
            { major: { name: "Truyền thông và mạng máy tính" }, priority: 2 },
            { major: { name: "Hệ thống thông tin" }, priority: 3 },
          ],
          documents: [
            { document_type: "hoc_ba", original_filename: "hoc_ba_dung.pdf" },
            { document_type: "cccd", original_filename: "cccd_dung.jpg" },
          ],
        },
        {
          id: 5,
          user: { name: "Hoàng Văn Em", email: "hoangvanem@email.com" },
          submitted_at: "2025-01-11T11:30:00",
          status: "pending",
          aspirations: [{ major: { name: "Khoa học máy tính" }, priority: 1 }],
          documents: [
            { document_type: "hoc_ba", original_filename: "hoc_ba_em.pdf" },
            { document_type: "cccd", original_filename: "cccd_em.jpg" },
          ],
        },
      ];

      // Biến toàn cục
      let danhSachHoSo = duLieuDemo;
      let trangHienTai = "tongQuan";

      // Khởi tạo trang
      document.addEventListener("DOMContentLoaded", function () {
        hienThiHoSoGanDay();
      });

      // Đăng xuất
      function dangXuat() {
        if (confirm("Bạn có muốn đăng xuất?")) {
          window.location.href = "./trangchu.html";
        }
      }

      // Hiển thị trang
      function hienThiTrang(trang) {
        // Ẩn tất cả trang
        const cacTrang = document.querySelectorAll(".page-content");
        cacTrang.forEach((trang) => (trang.style.display = "none"));

        // Hiển thị trang được chọn
        document.getElementById(trang).style.display = "block";

        // Cập nhật menu active
        const cacMenu = document.querySelectorAll(".menu-link");
        cacMenu.forEach((menu) => menu.classList.remove("active"));
        event.target.classList.add("active");

        trangHienTai = trang;

        // Tải dữ liệu tương ứng
        if (trang === "tongQuan") {
          hienThiHoSoGanDay();
        } else if (trang === "hoSo") {
          hienThiDanhSachHoSo();
        }
      }

      // Hiển thị hồ sơ gần đây
      function hienThiHoSoGanDay() {
        const tableBody = document.getElementById("recentTableBody");
        const hoSoGanDay = danhSachHoSo.slice(0, 5);

        tableBody.innerHTML = hoSoGanDay
          .map(
            (hoSo) => `
                <tr>
                    <td>${hoSo.user.name}</td>
                    <td>${new Date(hoSo.submitted_at).toLocaleDateString(
                      "vi-VN"
                    )}</td>
                    <td><span class="status-badge status-${
                      hoSo.status
                    }">${layTenTrangThai(hoSo.status)}</span></td>
                    <td>
                        <button class="btn btn-primary" onclick="xemChiTiet(${
                          hoSo.id
                        })">
                            <i class="fas fa-eye"></i> Xem
                        </button>
                    </td>
                </tr>
            `
          )
          .join("");
      }

      // Hiển thị danh sách hồ sơ
      function hienThiDanhSachHoSo(hoSoLoc = null) {
        const tableBody = document.getElementById("applicationsTableBody");
        const danhSachHienThi = hoSoLoc || danhSachHoSo;

        tableBody.innerHTML = danhSachHienThi
          .map(
            (hoSo) => `
                <tr>
                    <td>${hoSo.user.name}</td>
                    <td>${hoSo.user.email}</td>
                    <td>${new Date(hoSo.submitted_at).toLocaleDateString(
                      "vi-VN"
                    )}</td>
                    <td>${
                      hoSo.aspirations ? hoSo.aspirations.length : 0
                    } nguyện vọng</td>
                    <td><span class="status-badge status-${
                      hoSo.status
                    }">${layTenTrangThai(hoSo.status)}</span></td>
                    <td>
                        <button class="btn btn-primary" onclick="xemChiTiet(${
                          hoSo.id
                        })">
                            <i class="fas fa-eye"></i> Xem
                        </button>
                        <button class="btn btn-success" onclick="capNhatTrangThai(${
                          hoSo.id
                        }, 'approved')">
                            <i class="fas fa-check"></i> Duyệt
                        </button>
                        <button class="btn btn-danger" onclick="capNhatTrangThai(${
                          hoSo.id
                        }, 'rejected')">
                            <i class="fas fa-times"></i> Từ chối
                        </button>
                    </td>
                </tr>
            `
          )
          .join("");
      }

      // Lọc hồ sơ
      function locHoSo() {
        const trangThai = document.getElementById("filterTrangThai").value;
        const tuKhoa = document
          .getElementById("searchInput")
          .value.toLowerCase();

        let hoSoLoc = danhSachHoSo;

        // Lọc theo trạng thái
        if (trangThai) {
          hoSoLoc = hoSoLoc.filter((hs) => hs.status === trangThai);
        }

        // Lọc theo từ khóa
        if (tuKhoa) {
          hoSoLoc = hoSoLoc.filter(
            (hs) =>
              hs.user.name.toLowerCase().includes(tuKhoa) ||
              hs.user.email.toLowerCase().includes(tuKhoa)
          );
        }

        hienThiDanhSachHoSo(hoSoLoc);
      }

      // Tìm kiếm hồ sơ
      function timKiemHoSo() {
        locHoSo();
      }

      // Lấy tên trạng thái
      function layTenTrangThai(status) {
        const trangThai = {
          pending: "Chờ xử lý",
          processing: "Đang xử lý",
          approved: "Đã duyệt",
          rejected: "Từ chối",
        };
        return trangThai[status] || status;
      }

      // Xem chi tiết hồ sơ
      function xemChiTiet(hoSoId) {
        const hoSo = danhSachHoSo.find((hs) => hs.id === hoSoId);
        if (hoSo) {
          hienThiModalChiTiet(hoSo);
        }
      }

      // Hiển thị modal chi tiết
      function hienThiModalChiTiet(hoSo) {
        const modal = document.getElementById("modalChiTiet");
        const content = document.getElementById("modalContent");

        content.innerHTML = `
                <div style="margin-bottom: 20px;">
                    <h4>Thông tin thí sinh</h4>
                    <p><strong>Tên:</strong> ${hoSo.user.name}</p>
                    <p><strong>Email:</strong> ${hoSo.user.email}</p>
                    <p><strong>Ngày nộp:</strong> ${new Date(
                      hoSo.submitted_at
                    ).toLocaleDateString("vi-VN")}</p>
                    <p><strong>Trạng thái:</strong> <span class="status-badge status-${
                      hoSo.status
                    }">${layTenTrangThai(hoSo.status)}</span></p>
                </div>

                <div style="margin-bottom: 20px;">
                    <h4>Nguyện vọng</h4>
                    ${
                      hoSo.aspirations
                        ? hoSo.aspirations
                            .map(
                              (nv, index) => `
                        <div style="border: 1px solid #e5e7eb; padding: 10px; margin: 5px 0; border-radius: 6px;">
                            <p><strong>Nguyện vọng ${index + 1}:</strong> ${
                                nv.major ? nv.major.name : "N/A"
                              }</p>
                            <p><strong>Thứ tự ưu tiên:</strong> ${
                              nv.priority
                            }</p>
                        </div>
                    `
                            )
                            .join("")
                        : "<p>Không có nguyện vọng</p>"
                    }
                </div>

                <div style="margin-bottom: 20px;">
                    <h4>Tài liệu đính kèm</h4>
                    ${
                      hoSo.documents
                        ? hoSo.documents
                            .map(
                              (doc) => `
                        <div style="border: 1px solid #e5e7eb; padding: 10px; margin: 5px 0; border-radius: 6px;">
                            <p><strong>Loại tài liệu:</strong> ${doc.document_type}</p>
                            <p><strong>Tên file:</strong> ${doc.original_filename}</p>
                        </div>
                    `
                            )
                            .join("")
                        : "<p>Không có tài liệu</p>"
                    }
                </div>

                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-success" onclick="capNhatTrangThai(${
                      hoSo.id
                    }, 'approved')">
                        <i class="fas fa-check"></i> Duyệt hồ sơ
                    </button>
                    <button class="btn btn-danger" onclick="capNhatTrangThai(${
                      hoSo.id
                    }, 'rejected')">
                        <i class="fas fa-times"></i> Từ chối hồ sơ
                    </button>
                </div>
            `;

        modal.style.display = "block";
      }

      // Cập nhật trạng thái hồ sơ (Demo)
      function capNhatTrangThai(hoSoId, trangThaiMoi) {
        if (
          !confirm(
            `Bạn có chắc muốn ${
              trangThaiMoi === "approved" ? "duyệt" : "từ chối"
            } hồ sơ này?`
          )
        ) {
          return;
        }

        // Cập nhật dữ liệu demo
        const hoSo = danhSachHoSo.find((hs) => hs.id === hoSoId);
        if (hoSo) {
          hoSo.status = trangThaiMoi;
          alert("Cập nhật trạng thái thành công! (Demo)");
          dongModal();

          // Tải lại dữ liệu
          if (trangHienTai === "tongQuan") {
            hienThiHoSoGanDay();
          } else if (trangHienTai === "hoSo") {
            hienThiDanhSachHoSo();
          }
        }
      }

      // Đóng modal
      function dongModal() {
        document.getElementById("modalChiTiet").style.display = "none";
      }

      // Đóng modal khi click bên ngoài
      window.onclick = function (event) {
        const modal = document.getElementById("modalChiTiet");
        if (event.target === modal) {
          dongModal();
        }
      };
    </script>
  </body>
</html>
